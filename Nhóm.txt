
USE social_network;

CREATE TABLE tbl_user (
  id INT NOT NULL PRIMARY KEY,
  ten VARCHAR(255) NOT NULL,
  sdt VARCHAR(20) NOT NULL UNIQUE,
  diachi VARCHAR(255) NOT NULL,
  username VARCHAR(255) NOT NULL,
  password1 VARCHAR(255) NOT NULL,
  email VARCHAR(255) NOT NULL UNIQUE,
  dateOfBirth Date,
  role_id INT NOT NULL,
  status1 INT NOT NULL,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_role (
  id INT NOT NULL PRIMARY KEY,
  des VARCHAR(255) NOT NULL,
  roleName VARCHAR(255) NOT NULL,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_post (
  id INT NOT NULL PRIMARY KEY,
  content TEXT NOT NULL,
  user_id INT NOT NULL,
  status1 VARCHAR(255) NOT NULL,
  comments INT,
  likes INT,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_comment (
  id INT NOT NULL PRIMARY KEY,
  post_id INT NOT NULL,
  user_id INT NOT NULL,
  content  TEXT NOT NULL,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_image (
  id INT NOT NULL PRIMARY KEY,
  post_id INT NOT NULL,
  user_id INT NOT NULL,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_like (
  id INT NOT NULL PRIMARY KEY,
  post_id INT NOT NULL,
  user_id INT NOT NULL,
  comment_id INT NOT NULL,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_follower (
  id INT NOT NULL PRIMARY KEY,
  follower_id INT NOT NULL,
  following_id INT NOT NULL,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_friend (
  id INT NOT NULL PRIMARY KEY,
  request_id INT NOT NULL,
  accept_id INT,
  status1 INT,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_blockUser (
  id INT NOT NULL PRIMARY KEY,
  blocker_id INT NOT NULL,
  blocked_id INT NOT NULL,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_boxChat (
  id INT NOT NULL PRIMARY KEY,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_user_boxChat (
  id INT NOT NULL PRIMARY KEY,
  user_id INT NOT NULL,
  boxChat_id INT NOT NULL,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

CREATE TABLE tbl_chat (
  id INT NOT NULL PRIMARY KEY,
  user_id INT NOT NULL,
  boxChat_id INT NOT NULL,
  content  TEXT,
  created_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at  TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  deleted_at  TIMESTAMP NULL DEFAULT NULL
);

ALTER TABLE tbl_user ADD CONSTRAINT tbl_user_role_id_fk FOREIGN KEY (role_id) REFERENCES tbl_role(id);
ALTER TABLE tbl_post ADD CONSTRAINT tbl_post_user_id_fk FOREIGN KEY (user_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_comment ADD CONSTRAINT tbl_comment_user_id_fk FOREIGN KEY (user_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_comment ADD CONSTRAINT tbl_comment_post_id_fk FOREIGN KEY (post_id) REFERENCES tbl_post(id);
ALTER TABLE tbl_image ADD CONSTRAINT tbl_image_user_id_fk FOREIGN KEY (user_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_image ADD CONSTRAINT tbl_image_post_id_fk FOREIGN KEY (post_id) REFERENCES tbl_post(id);
ALTER TABLE tbl_like ADD CONSTRAINT tbl_like_user_id_fk FOREIGN KEY (user_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_like ADD CONSTRAINT tbl_like_post_id_fk FOREIGN KEY (post_id) REFERENCES tbl_post(id);
ALTER TABLE tbl_like ADD CONSTRAINT tbl_like_comment_id_fk FOREIGN KEY (comment_id) REFERENCES tbl_comment(id);
ALTER TABLE tbl_follower ADD CONSTRAINT tbl_follower_follower_id_fk FOREIGN KEY (follower_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_follower ADD CONSTRAINT tbl_follower_following_id_fk FOREIGN KEY (following_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_friend ADD CONSTRAINT tbl_friend_request_id_fk FOREIGN KEY (request_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_friend ADD CONSTRAINT tbl_friend_accept_id_fk FOREIGN KEY (accept_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_blockUser ADD CONSTRAINT tbl_blockUser_blocker_id_fk FOREIGN KEY (blocker_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_user_boxChat ADD CONSTRAINT tbl_user_boxChat_user_id_fk FOREIGN KEY (user_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_user_boxChat ADD CONSTRAINT tbl_user_boxChat_boxChat_id_fk FOREIGN KEY (boxChat_id) REFERENCES tbl_boxChat(id);
ALTER TABLE tbl_chat ADD CONSTRAINT tbl_chat_user_id_fk FOREIGN KEY (user_id) REFERENCES tbl_user(id);
ALTER TABLE tbl_chat ADD CONSTRAINT tbl_chat_boxChat_id_fk FOREIGN KEY (boxChat_id) REFERENCES tbl_boxChat(id);